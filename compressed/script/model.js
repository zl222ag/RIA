define(["backbone"],function(e){return e.Model.extend({defaults:{HEADER_TEXT:"The Insert Text Game!",DEFAULT_LANG:"en",WORDLISTS_DIRECTORY:"wordlists/",WORDLIST_EXTENSION:".txt",words:null,wordId:0,currentLetterId:0,score:0,lang:null},getCurrentWord:function(){return this.get("words")[this.get("wordId")]},validate:function(){},keyPress:function(e){var t=this;return function(n){var r=null;n.preventDefault();if(n.ctrlKey||n.charCode<32)return;r=String.fromCharCode(n.charCode).toLowerCase(),t.getCurrentWord()[t.get("currentLetterId")]===r&&(e(r),t.set("currentLetterId",t.get("currentLetterId")+1),t.get("currentLetterId")>=t.getCurrentWord().length&&(t.deletePastWord(),t.pickWord()))}},deletePastWord:function(){this.get("words").pop(this.get("wordId"))},pickWord:function(){this.set("wordId",Math.floor(Math.random()*this.get("words").length)),this.set("currentLetterId",0)},getWordList:function(){var e=this;$.ajax({url:e.get("WORDLISTS_DIRECTORY")+e.get("lang")+e.get("WORDLIST_EXTENSION"),dataType:"text",contentType:"text/plain; charset=utf-8",success:function(t){e.set("words",t.trimLeft().trimRight().split(/\n+/)),e.pickWord()},error:function(){e.get("lang")===e.get("DEFAULT_LANG")?alert("Couldn't load the wordlist =(."):(e.set("lang",e.get("DEFAULT_LANG")),e.getWordList())}})},initialize:function(){var e=0,t=null;t=navigator.language||navigator.userLanguage,e=t.indexOf("-"),e>0&&this.set("lang",t.substr(0,e))}})});