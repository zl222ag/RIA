define(["backbone"],function(e){return e.Model.extend({HEADER_TEXT:"The Insert Text Game!",DEFAULT_LANG:"en",WORDLISTS_DIRECTORY:"wordlists/",WORDLIST_EXTENSION:".txt",CHAR_FORMAT:/^[a-z'\-]$/,words:null,wordId:0,currentLetterId:0,score:0,lang:null,getCurrentWord:function(){return this.words[this.wordId]},keyPress:function(e){var t=this;return function(n){var r=null;if(n.ctrlKey)return;r=String.fromCharCode(n.charCode).toLowerCase(),t.CHAR_FORMAT.test(r)&&t.getCurrentWord()[t.currentLetterId]===r&&(e(r),t.currentLetterId+=1,t.currentLetterId>=t.getCurrentWord().length&&(t.deletePastWord(),t.pickWord()))}},deletePastWord:function(){this.words.pop(this.wordId)},pickWord:function(){this.wordId=Math.floor(Math.random()*this.words.length),this.currentLetterId=0},getWordList:function(e){var t=this;$.ajax({url:t.WORDLISTS_DIRECTORY+t.lang+t.WORDLIST_EXTENSION,dataType:"text",contentType:"text/plain; charset=utf-8",success:function(n){t.words=n.trimLeft().trimRight().split(/\n+/),t.pickWord(),e()},error:function(){t.lang===t.DEFAULT_LANG?alert("Couldn't load the wordlist =(."):(t.lang=t.DEFAULT_LANG,t.getWordList())}})},initialize:function(){var e=0;this.lang=navigator.language||navigator.userLanguage,e=this.lang.indexOf("-"),e>0&&(this.lang=this.lang.substr(0,e))}})});