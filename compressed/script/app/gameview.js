define(["backbone","jade"],function(e,t){return e.View.extend({ACCEPTABLE_CHAR_INDEX:65,WORD_CONTAINER_TAG_FORMAT:"div.text-center",CLEARED_WORD_TAG_FORMAT:"span.cleared",WORD_TAG_FORMAT:"span",INPUT_WORD_TAG_FORMAT:'input(type="text", maxlength=5, autocapitalize="off", autocorrect="off", autocomplete="off")#inputword.text-center',HEADER_TAG_FORMAT:"h1.text-container.text-center #{text}",CONTAINER_TAG_FORMAT:"div.container",STATUS_TAG_FORMAT:"div.status\n	span.glyphicon.glyphicon-info-sign",SCORE_TEXT_TAG_FORMAT:"span.score 0",HIGHSCORE_TEXT_TAG_FORMAT:"span.highscore 0",WORD_TEXT_TAG_FORMAT:"span.word -1/314",el:"div#wrapper",clearedWordTag:null,wordTag:null,inputWordTag:null,statusTag:null,scoreNode:null,wordNode:null,keysDown:{},getHeaderText:function(){return this.model.get("HEADER_TEXT")},onKeyDown:function(e){if(e.ctrlKey||e.keyCode!==0&&e.keyCode<this.ACCEPTABLE_CHAR_INDEX||this.keysDown[e.keyCode.toString()]===!0)return!1;this.keysDown[e.keyCode.toString()]=!0},onKeyUp:function(e){var t=null,n=0,r=null;e.preventDefault();if(e.keyCode!==0&&(e.ctrlKey||e.keyCode<this.ACCEPTABLE_CHAR_INDEX))return!1;this.keysDown[e.keyCode.toString()]=!1,r=this.inputWordTag.val().substr(0,1).toLowerCase(),this.inputWordTag.val(this.inputWordTag.val().substr(1)),this.model.guessChar(r)&&(n=this.model.get("currentLetterId"),t=this.model.getCurrentWord(),t!==undefined&&(this.clearedWordTag.text(t.substr(0,n)),this.wordTag.text(t.substr(n))))},selectionKiller:function(e){e.target.focus(),e.preventDefault()},onChangeWord:function(){this.clearedWordTag.text(""),this.wordTag.text(this.model.getCurrentWord()),this.wordNode.nodeValue=(this.model.NUMBER_OF_WORDS-this.model.get("words").length+1).toString()+"/"+this.model.NUMBER_OF_WORDS.toString()},onChangeScore:function(){this.scoreNode.nodeValue=this.model.getScore().toString()},onChangeHighscore:function(){this.highscoreNode.nodeValue=this.model.getHighscore().toString()},onNewHighScore:function(e){alert(e)},onNewGame:function(){this.inputWordTag.val("")},events:{"keydown input#inputword":"onKeyDown","keyup input#inputword":"onKeyUp","mousedown input#inputword":"selectionKiller"},initialize:function(){this.listenTo(this.model,"change:wordId",this.onChangeWord),this.listenTo(this.model,"change:score",this.onChangeScore),this.listenTo(this.model,"change:highscore",this.onChangeHighscore),this.listenTo(this.model,"beat-highscore",this.onNewHighScore),this.listenTo(this.model,"newgame",this.onNewGame),_.bind(this.onKeyUp,this),_.bind(this.onKeyDown,this)},render:function(){var e=null,n=null,r=null,i=null,s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null,d=null,v=null;return document.title=this.getHeaderText(),e=t.compile(this.HEADER_TAG_FORMAT),n=t.compile(this.CONTAINER_TAG_FORMAT),i=t.compile(this.WORD_CONTAINER_TAG_FORMAT),s=t.compile(this.CLEARED_WORD_TAG_FORMAT),o=t.compile(this.WORD_TAG_FORMAT),u=t.compile(this.INPUT_WORD_TAG_FORMAT),a=t.compile(this.STATUS_TAG_FORMAT),f=t.compile(this.SCORE_TEXT_TAG_FORMAT),l=t.compile(this.HIGHSCORE_TEXT_TAG_FORMAT),c=t.compile(this.WORD_TEXT_TAG_FORMAT),h=$(i()),r=$(n()),this.clearedWordTag=$(s()),this.wordTag=$(o()),this.inputWordTag=$(u()),this.statusTag=$(a()),p=$(f()),d=$(l()),v=$(c()),this.scoreNode=p.contents().eq(0)[0],this.highscoreNode=d.contents().eq(0)[0],this.wordNode=v.contents().eq(0)[0],this.$el.prepend(e({text:this.getHeaderText()})),h.append(this.clearedWordTag),h.append(this.wordTag),this.statusTag.append(p),this.statusTag.append(d),this.statusTag.append(v),r.append(h),r.append(this.inputWordTag),r.append(this.statusTag),this.$el.append(r),this}})});